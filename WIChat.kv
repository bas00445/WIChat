<WIChat>:
    startupScreen: StartupScreen
    mainUIScreen: MainUIScreen
    chatroomScreen: ChatroomScreen

    StartupScreen:
        id: StartupScreen
    MainUIScreen:
        id: MainUIScreen
    ChatroomScreen:
        id: ChatroomScreen

<StartupScreen>:
    name: "StartupScreen"

    nameInput: nameInput
    ipInput: ipInput
    portInput: portInput

    BoxLayout:
        orientation: 'vertical'
        spacing: 5
        Button:
            id: StartupLabel
            text: "Start Up"
            size_hint: 1, .2

        BoxLayout:
            orientation: 'horizontal'
            Label:
                text: "NICKNAME\n(Max length = 8)"
                size_hint_x: .3
                halign: 'center'
            TextInput:
                id: nameInput
                text: "Untitiled"
                multiline: False
                size_hint_x: .7
                input_filter: lambda text, from_undo: text[:8 - len(self.text)]

        BoxLayout:
            orientation: 'horizontal'
            Label:
                text: "HOST IP"
                size_hint_x: .3
            TextInput:
                id: ipInput
                text: "127.0.0.1"
                multiline: False
                size_hint_x: .7

        BoxLayout:
            orientation: 'horizontal'
            Label:
                text: "PORT"
                size_hint_x: .3
            TextInput:
                id: portInput
                text: "5000"
                multiline: False
                size_hint_x: .7


        BoxLayout:
            orientation: 'horizontal'
            size_hint: 1, .3
            Button:
                id: loginButton
                text: "LOG IN AS CLIENT"
                on_release: root.login()

            Button:
                id: loginButton
                text: "BECOME A HOST"
                on_release: root.openHostPopup()

<ProfileArea>:

    orientation: 'horizontal'
    profileButton: profileButton

    idButton: idButton
    nameButton: nameButton
    statusButton: statusButton
    size_hint: (1, .2)
    padding: 8

    canvas.before:
        Color:
            rgba: 0.027, 0.412, 0.698, 1
        Rectangle:
            pos: self.pos
            size: self.size

    Button:
        id: profileButton
        text: "Profile"
        size_hint_x: .3
        background_normal: 'backgroundPic.png'
        background_color: 0.196, 0.663, 0.914,  1
        border: 30,30,30,30

    BoxLayout:
        padding: 8
        spacing: 4
        orientation: 'vertical'

        Button:
            id: idButton
            text: "ID"
            size_hint_y: .2
            background_normal: ''
            background_color: 0.196, 0.663, 0.914,  1

        Button:
            id: nameButton
            text: "Name"
            size_hint_y: .2
            background_normal: ''
            background_color: 0.196, 0.663, 0.914,  1

        Button:
            id: statusButton
            text: "Status"
            size_hint_y: .2
            background_normal: ''
            background_color: 0.196, 0.663, 0.914,  1

<MenuBar>:
    orientation: 'horizontal'
    contactButton: contactButton
    historyButton: historyButton
    settingButton: settingButton
    size_hint: (1, .1)

    Button:
        text: 'Contact'
        id: contactButton
        background_normal: ''
        background_color: 0, 0.659, 0.925,  1

        on_release: app.root.mainUIScreen.changeScreen('contact')
        on_release: app.root.mainUIScreen.updateContact()

    Button:
        text: 'History'
        id: historyButton
        background_normal: ''
        background_color: 0, 0.439, 0.620,  1

        on_release: app.root.mainUIScreen.changeScreen('history')

    Button:
        text: 'Setting'
        id: settingButton
        background_normal: ''
        background_color: 0.008, 0.267, 0.463,  1



<ContactComponent>:
    orientation: 'horizontal'
    size_hint: 1, None
    idButton: idButton
    nameButton: nameButton
    statusButton: statusButton

    Button:
        background_normal: ''
        background_color: 0.196, 0.663, 0.914,  1
        size_hint: .3, 1
        text: 'Pic'

    BoxLayout:
        orientation: 'vertical'

        Button:
            background_normal: ''
            background_color: 0.369, 0.545, 0.776, 1

            id: idButton


        Button:
            background_normal: ''
            background_color: 0.369, 0.545, 0.776, 1

            id: nameButton
            on_release: app.root.current = "ChatroomScreen"
            on_release: app.root.mainUIScreen.setClientTarget(idButton.text, nameButton.text)

        Button:
            background_normal: ''
            background_color: 0.369, 0.545, 0.776, 1
            id: statusButton
            text: "None"


<ContactScreen>:
    orientation: 'vertical'
    contactScrollView: contactScrollView

    Accordion:
        orientation: 'vertical'

        AccordionItem:
            title: 'Available Groups'
            Button:
                text: 'Group Layout'

        AccordionItem:
            title: 'Available Contacts'

            ScrollView:
                size: self.parent.width, self.parent.height
                GridLayout:
                    id: contactScrollView
                    cols: 1
                    padding: 10
                    spacing: 10
                    size_hint: 1,None
                    height: self.minimum_height




<HistoryScreen>:
    orientation: 'vertical'
    historyScrollView: historyScrollView

    ScrollView:
        size: self.parent.width, self.parent.height
        size_hint: 1, None
        GridLayout:
            id: historyScrollView
            cols: 1
            padding: 10
            spacing: 10
            size_hint: 1,None
            height: self.minimum_height

<HistoryComponent>:
    orientation: 'horizontal'
    size_hint: 1, None
    idButton: idButton
    nameButton: nameButton
    lastestMessage: lastestMessage

    Button:
        background_normal: ''
        background_color: 0.196, 0.663, 0.914,  1
        size_hint: .3, 1
        text: 'Pic'

    BoxLayout:
        orientation: 'vertical'

        Button:
            background_normal: ''
            background_color: 0.369, 0.545, 0.776, 1

            id: idButton


        Button:
            background_normal: ''
            background_color: 0.369, 0.545, 0.776, 1

            id: nameButton
            on_release: app.root.current = "ChatroomScreen"
            on_release: app.root.mainUIScreen.setClientTarget(idButton.text, nameButton.text)

        Button:
            background_normal: ''
            background_color: 0.369, 0.545, 0.776, 1
            id: lastestMessage
            text: "None"



<ScreenSlider>:
    anim_move_duration: .3
    anim_cancel_duration: .5

    canvas.before:
        Color:
            rgba: 0.804, 0.804, 0.804, 1
        Rectangle:
            pos: self.pos
            size: self.size

    contactScreen: contactScreen
    historyScreen: historyScreen

    ContactScreen:
        id: contactScreen
    HistoryScreen:
        id: historyScreen

<MainUIScreen>:
    name: "MainUIScreen"
    profileArea: profileArea
    menuBar: menuBar
    screenSlider: screenSlider

    BoxLayout:
        orientation: 'vertical'
        ProfileArea:
            id: profileArea
        MenuBar:
            id: menuBar
        ScreenSlider:
            id: screenSlider

<MessageBox>:
    orientation: 'horizontal'
    senderName: senderName
    message: message
    sendTime: sendTime
    size_hint: 1, None

    Label:
        id: senderName

        canvas.before:
            Color:
                rgba: 0.804, 0.804, 0.804, 1
            Rectangle:
                pos: self.pos
                size: self.size

    BoxLayout:
        orientation: 'vertical'
        Label:
            id: message

            canvas.before:
                Color:
                    rgba: 0.804, 0.804, 0.804, 1
                Rectangle:
                    pos: self.pos
                    size: self.size

        Label:
            id: sendTime

            canvas.before:
                Color:
                    rgba: 0.804, 0.804, 0.804, 1
                Rectangle:
                    pos: self.pos
                    size: self.size


<ChatroomScreen>:
    name: "ChatroomScreen"
    scrollView_chat: scrollView_chat
    chatContainer: chatContainer
    messageInput: messageInput
    roomName: roomName


    BoxLayout:
        orientation: 'vertical'
        messageInput: messageInput

        BoxLayout:
            orientation: "horizontal"
            size_hint: 1, .1

            Button:
                background_normal: ''
                background_color: 0.369, 0.545, 0.776, 1

                id: roomName
                text: "Chatroom"
                size_hint_x: .8
                on_release: root.updateMessage()

            Button:
                background_normal: ''
                background_color: 0.008, 0.267, 0.463, 1
                text: "Back"
                size_hint_x: .2
                on_release: app.root.current = "MainUIScreen"

        ScrollView:
            id: scrollView_chat
            size: self.parent.width, self.parent.height
            do_scroll_x: False

            canvas.before:
                Color:
                    rgba: 0.804, 0.804, 0.804, 1
                Rectangle:
                    pos: self.pos
                    size: self.size

            GridLayout:
                id: chatContainer
                cols: 1
                padding: 10
                spacing: 10
                size_hint: 1,None
                height: self.minimum_height

        BoxLayout:
            canvas.before:
                Color:
                    rgba: 0.565, 0.663, 0.840, 1
                Rectangle:
                    pos: self.pos
                    size: self.size

            padding: 6
            orientation: 'horizontal'
            size_hint: 1, .1
            TextInput:
                id: messageInput
                size_hint: .8, 1
            Button:
                background_normal: ''
                background_color: 0.071, 0.4, 0.840, 1

                id: sendButton
                text: "SEND"
                size_hint: .2, 1
                on_release: app.root.clientSocket.setText(messageInput.text)
                on_release: root.sendMessageTask()

